""" 在之前的 PIN-WM 代码框架中，这个函数可能的用途：
物理参数约束：将模型优化过程中的物理参数（如摩擦系数、恢复系数）映射到合理区间（比如摩擦系数通常在 0~1 之间），避免参数出现物理上不合理的值（如负数、大于 1 的极端值）；
概率输出：若论文中有分类或决策逻辑（如判断物体是否碰撞、操作是否成功），可将模型输出通过 Sigmoid 转换为概率值；
损失函数适配：在某些场景下，将差值类损失（如参数估计误差）映射到 (0,1) 区间，让损失计算更稳定。 """
# 导入numpy库（用于高效的数值计算，尤其是指数运算np.exp）
import numpy as np

def sigmoid(x):
    """
    实现Sigmoid激活函数（逻辑斯蒂函数）
    核心作用：将任意实数输入映射到 (0, 1) 区间内，输出值可理解为概率或归一化后的参数
    
    数学公式：σ(x) = 1 / (1 + e^(-x))
    关键特性：
    1. 输入x ∈ (-∞, +∞)，输出σ(x) ∈ (0, 1)（不包括0和1，接近边界时趋近于这两个值）
    2. 导数特性：σ'(x) = σ(x) * (1 - σ(x))（梯度计算高效，适合反向传播）
    3. 单调性：输入越大，输出越接近1；输入越小，输出越接近0

    Args:
        x: 输入值（可是单个实数、numpy数组，支持批量计算）
    Returns:
        映射到(0,1)区间的输出值（与输入x的形状一致）
    """
    # 计算Sigmoid函数值：1除以（1加上e的(-x)次方）
    # np.exp(-x)：numpy的指数函数，计算e^(-x)（支持数组元素级运算）
    return 1 / (1 + np.exp(-x))